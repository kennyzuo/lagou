### æ¨¡å—åŒ–çš„æ¼”è¿›è¿‡ç¨‹

#### é€šè¿‡æ–‡ä»¶çš„åˆ’åˆ†æ–¹å¼æ¥è¿›è¡Œæ¨¡å—åŒ–

> å°†ä¸åŒåŠŸèƒ½æ¨¡å—é€šè¿‡æ–‡ä»¶çš„æ–¹å¼åŠ ä»¥åŒºåˆ†ï¼Œç„¶ååœ¨ html ä¸­åˆ†åˆ«å¼•å…¥ï¼ˆ script æ ‡ç­¾å¼•å…¥ ï¼‰ï¼Œä¸åŒæ¨¡å—çš„æ–¹æ³•å¯ä»¥åœ¨å…¨å±€å˜é‡ç›´æ¥è®¿é—®ã€ä¿®æ”¹

ç¼ºç‚¹

- æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸ
- å‘½åå†²çªé—®é¢˜
- æ— æ³•ç®¡ç†æ¨¡å—ä¾èµ–å…³ç³»

æ¨¡å—åŒ–å®Œå…¨ä¾é çº¦å®šï¼ˆå¼€å‘è§„èŒƒï¼‰ï¼Œå½“é¡¹ç›®ä½“é‡è¿‡å¤§æ—¶å€™å°†æ— æ³•è‰¯å¥½çš„ç®¡ç†

#### å‘½åç©ºé—´æ–¹å¼

> åœ¨ç¬¬ä¸€ç§çš„æ–¹å¼å‰æä¸‹ï¼Œæ¯ä¸ªæ¨¡å—å¯¹å¤–ğŸˆ¯åªæš´éœ²ä¸€ä¸ªå…¨å±€å¯¹è±¡

è¿™ä¸ªæ–¹å¼è§£å†³äº†éƒ¨åˆ†å‘½åå†²çªçš„é—®é¢˜ï¼Œä½†æ˜¯ä¾ç„¶å­˜åœ¨ 1. å…¨å±€ä½œç”¨åŸŸæ±¡æŸ“ï¼›2. æ¨¡å—é—´æ— æ³•ç®¡ç†ä¾èµ– é—®é¢˜ï¼›

#### æ¨¡å—åŒ–è§„èŒƒ

CommonJS è§„èŒƒ

> 1. æ¯ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªæ¨¡å—ï¼›2.æ¯ä¸ªæ¨¡å—éƒ½æœ‰å•ç‹¬ä½œç”¨åŸŸï¼›3. modules.exports å¯¼å‡ºï¼›4. require å¼•å…¥

- node ç«¯ä½¿ç”¨
- åŒæ­¥æ¨¡å¼åŠ è½½æ¨¡å—ï¼ˆnode æ‰§è¡Œæœºåˆ¶æ˜¯å¯åŠ¨çš„æ—¶å€™åŠ è½½æ¨¡å—ï¼‰

æ— æ³•åœ¨æµè§ˆå™¨ç«¯ä½¿ç”¨ï¼Œæ¯æ¬¡é¡µé¢åŠ è½½éƒ½ä¼šæœ‰å¤§é‡çš„åŒæ­¥ä»£ç åŠ è½½ï¼Œæ•ˆç‡åº•ä¸‹

AMD è§„èŒƒ

Require.js ç±»åº“å®ç°äº† AMD è§„èŒƒï¼Œå¼ºå¤§çš„æ¨¡å—åŠ è½½å™¨

ç®€å•ç¤ºä¾‹

```javascript
// å®šä¹‰ä¸€ä¸ªæ¨¡å—
define('module1', ['jquery', './module2], function($, module2) {
  return {
    start: function() {
      console.log('I am module1');
      module2()
    }
  }
});

// è½½å…¥æ¨¡å—(è‡ªåŠ¨åˆ›å»º scriptï¼Œå‘é€ ajaax è¯·æ±‚è·å–å¯¹åº”æ¨¡å—è„šæœ¬)
require(['./module1'], function(module1) {
  module1.start();
});

```

ç›®å‰ä¸»æµçš„ç¬¬ä¸‰æ–¹åº“å¤§éƒ½æ”¯æŒ AMDï¼Œ AMD çš„ç”Ÿæ€æ¯”è¾ƒè‰¯å¥½

ä¸€äº›ç¼ºç‚¹

- AMD ä½¿ç”¨ç›¸å¯¹å¤æ‚ï¼Œæœ‰ä¸€å®šå­¦ä¹ æˆæœ¬
- æ¨¡å— JS æ–‡ä»¶è¯·æ±‚é¢‘ç¹



Sea.js + CMD (æ·˜å®æä¾›ä¸€å¥—è§„èŒƒ)

ç®€å•ç¤ºä¾‹

```javascript
// CMD è§„èŒƒ
define(function(require, exports, module) {
  // é€šè¿‡ require å¼•å…¥ä¾èµ–
  var $ = require('jquery');
  // é€šè¿‡ exports æˆ–è€… module.exports å¯¹å¤–æš´éœ²æˆå‘˜
  module.exports = function() {
    console.log('module 2~');
  }
})
```

æ¨¡å—åŒ–çš„æœ€ä½³å®è·µ

- node ç«¯ä½¿ç”¨ CommonJS
- æµè§ˆå™¨ç«¯ä½¿ç”¨ ES Modulesï¼ˆES6 å®šä¹‰çš„æ¨¡å—ç³»ç»Ÿï¼Œå­˜åœ¨ç¯å¢ƒå…¼å®¹é—®é¢˜ï¼‰ï¼ŒåŸç”Ÿè¯­è¨€æ”¯æŒ


#### ES Modules

- è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œå¿½ç•¥ use strict
- æ¯ä¸ª ESM å…·æœ‰å•ç‹¬çš„ä½œç”¨åŸŸï¼Œå…¶å®ƒæ¨¡å—æ— æ³•è®¿é—®ç§æœ‰å˜é‡
- ESM é€šè¿‡ CORS æ–¹å¼åŠ è½½å¤–éƒ¨ JS è„šæœ¬ï¼Œè¿™è¦æ±‚å¤–éƒ¨ JS å¿…é¡»æ”¯æŒ CORS
- ä¸æ”¯æŒ file æ–¹å¼è®¿é—®ï¼Œéœ€è¦åœ¨ http serve æƒ…å†µä¸‹ä½¿ç”¨

ä¸€äº›ç¤ºä¾‹

```javascript
/** module.js **/ 
export let name = 'xiaodaidai';
export function foo() { console.log(name) }

let age = 18;
function bar() { console.log('bar') }
function defaultFn() {console.log('default fun')}

export {
  age as newAge,
  bar as newBar,
  defaultFn as default
}
// export.default ç‰¹æ®Šç”¨æ³•
// export.default = defaultFn

/** app.js **/
import { name, foo, newAge, default as defaultFn } from './module.js';
// export.default ç‰¹æ®Šç”¨æ³•
// import defaultFn from './module.js'

```

export æ³¨æ„äº‹é¡¹

- `export {}` æ˜¯å›ºå®šè¯­æ³•ï¼Œä¸æ˜¯å¯¹è±¡å­—é¢é‡
- `export default {}` è¿™é‡Œçš„æ˜¯å¯¹è±¡å­—é¢é‡
- `import {}` ä¹Ÿæ˜¯å›ºå®šç”¨æ³•ï¼Œä¹Ÿä¸æ˜¯è§£æ„
- export å¯¼å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œä¸æ˜¯æ‹·è´ï¼Œä¸”å¯¼å‡ºçš„å¼•ç”¨æ˜¯åªè¯»çš„

```javascript
// module.js
var name = 'xiaozuo'
export { name }
setTimeout(()=> {
  name = 'xiaowang';
}, 1000)
// app.js
import { name } from 'module.js'

console.log(name); // xiaozuo

setTimeout(()=> {
  console.log(name); // xiaowang
}, 1500)

name = 'xiaodaidai'; // æŠ¥é”™ï¼Œåªè¯»ä¸å¯ä¿®æ”¹
```

import æ³¨æ„äº‹é¡¹
- from åé¢çš„æ˜¯å®Œæ•´çš„è·¯å¾„åç§°ï¼Œä¸èƒ½çœç•¥ .js åç¼€åï¼Œä¸èƒ½çœç•¥ ./ 
- å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„
- å¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„
- å¯ä»¥ä½¿ç”¨å®Œæ•´çš„ url
- å¯ä»¥ä½¿ç”¨ `import './module.js'` æ‰§è¡Œæ¨¡å—è€Œä¸æå–
- å¯ä»¥ä½¿ç”¨ `import * as mod from './module.js'` å°†æ¨¡å—åŒ…è£…åœ¨ä¸€ä¸ªå¯¹è±¡ mod ä¸­

åŠ¨æ€å¯¼å…¥æ¨¡å—

```javascript
import('./module.js').then(function(module) {
  console.log(module);
})
```

å¯¼å…¥é»˜è®¤æˆå‘˜å’Œå…·åæˆå‘˜

```javascript
// module.js
let name = 'xiaodaidai';
export { name }
export default 'default export';

// app.js
import { name, default as title } from './module.js

// æˆ–è€…
// import title, {name} from './module.js'

```

import é…åˆ export ä½¿ç”¨

ä¸€èˆ¬åŒ–åœ¨ index.js æ¥ç»„ç»‡æ•£è½çš„æ–‡ä»¶æ—¶å€™ä½¿ç”¨

```javascript
// button.js
export const button = 'button';
// avator.js
export const avator = 'avator';
// index.js
export { button } from './button.js';
export { avator } from './avator.js';
// export { default as avator } from './avator.js';
```